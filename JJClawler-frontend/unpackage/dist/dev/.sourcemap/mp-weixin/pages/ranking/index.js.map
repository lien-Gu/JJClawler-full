{"version":3,"file":"index.js","sources":["pages/ranking/index.vue","pages/ranking/index.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"ranking-container\">\n    <!-- 搜索栏 -->\n    <view class=\"search-section\">\n      <input \n        class=\"search-input\" \n        placeholder=\"搜索榜单或书籍\"\n        v-model=\"searchKeyword\"\n        @input=\"onSearch\"\n      />\n    </view>\n\n    <!-- 面包屑导航 -->\n    <view class=\"breadcrumb\" v-if=\"selectedSite\">\n      <text class=\"breadcrumb-item\" @tap=\"resetToSiteLevel\">{{ currentSite.name }}</text>\n      <text class=\"breadcrumb-separator\" v-if=\"selectedChannel\"> > </text>\n      <text class=\"breadcrumb-item\" v-if=\"selectedChannel\" @tap=\"resetToChannelLevel\">{{ currentChannel.name }}</text>\n    </view>\n\n    <!-- 第一层级: 分站选择 - 始终显示 -->\n    <view class=\"level-container\">\n      <scroll-view class=\"site-scroll\" scroll-x=\"true\">\n        <view class=\"site-tabs\">\n          <view \n            class=\"site-tab\"\n            :class=\"{ active: selectedSite === site.id }\"\n            v-for=\"site in sites\" \n            :key=\"site.id\"\n            @tap=\"selectSite(site)\"\n          >\n            {{ site.name }}\n          </view>\n        </view>\n      </scroll-view>\n    </view>\n\n    <!-- 第二层级: 频道选择 - 当选中分站有子频道时显示 -->\n    <view class=\"level-container\" v-if=\"showChannelLevel\">\n      <scroll-view class=\"channel-scroll\" scroll-x=\"true\">\n        <view class=\"channel-tabs\">\n          <view \n            class=\"channel-tab\"\n            :class=\"{ active: selectedChannel === channel.id }\"\n            v-for=\"channel in currentSite.channels\" \n            :key=\"channel.id\"\n            @tap=\"selectChannel(channel)\"\n          >\n            {{ channel.name }}\n          </view>\n        </view>\n      </scroll-view>\n    </view>\n\n    <!-- 第三层级: 内容展示区域 -->\n    <view class=\"content-container\" v-if=\"showContentLevel\">\n      \n      <!-- 夹子特殊处理：显示书籍列表 -->\n      <view v-if=\"currentSite.type === 'special'\" class=\"book-list-container\">\n        <view class=\"section-header\">\n          <text class=\"section-title\">夹子榜单</text>\n          <button class=\"detail-btn\" @tap=\"goToJiaziDetail\">查看详情</button>\n        </view>\n        \n        <scroll-view class=\"book-list\" scroll-y=\"true\">\n          <view \n            class=\"book-item\"\n            v-for=\"(book, index) in bookList\" \n            :key=\"book.id\"\n          >\n            <view class=\"book-rank\">{{ index + 1 }}</view>\n            <view class=\"book-info\">\n              <view class=\"book-title\">{{ book.title }}</view>\n              <view class=\"book-stats\">\n                <text class=\"stat-item\">\n                  收藏: {{ book.collections }}\n                  <text class=\"change-indicator\" :class=\"book.collectionChange > 0 ? 'up' : 'down'\">\n                    {{ book.collectionChange > 0 ? '↑' : '↓' }}{{ Math.abs(book.collectionChange) }}\n                  </text>\n                </text>\n                <text class=\"stat-item\">\n                  排名变化: \n                  <text class=\"change-indicator\" :class=\"book.rankChange > 0 ? 'down' : 'up'\">\n                    {{ book.rankChange > 0 ? '↓' : '↑' }}{{ Math.abs(book.rankChange) }}\n                  </text>\n                </text>\n              </view>\n            </view>\n          </view>\n        </scroll-view>\n      </view>\n\n      <!-- 普通榜单：显示榜单列表 -->\n      <view v-else class=\"ranking-list-container\">\n        <scroll-view class=\"ranking-list\" scroll-y=\"true\">\n          <view \n            class=\"ranking-card\"\n            v-for=\"ranking in rankingList\" \n            :key=\"ranking.id\"\n            @tap=\"goToRankingDetail(ranking)\"\n          >\n            <view class=\"ranking-title\">{{ ranking.name }}</view>\n            <view class=\"ranking-desc\">{{ ranking.desc }}</view>\n            <view class=\"ranking-stats\">\n              <text class=\"stat-item\">{{ ranking.bookCount }} 本书籍</text>\n              <text class=\"stat-item\">{{ ranking.updateTime }}</text>\n            </view>\n          </view>\n        </scroll-view>\n      </view>\n      \n    </view>\n  </view>\n</template>\n\n<script>\nimport { getSitesList } from '@/data/url.js'\n\nexport default {\n  data() {\n    return {\n      searchKeyword: '',\n      selectedSite: '',\n      selectedChannel: '',\n      currentSite: {},\n      currentChannel: {},\n      sites: [],\n      rankingList: [],\n      bookList: [] // 夹子榜单的书籍列表\n    }\n  },\n  \n  computed: {\n    // 是否显示频道选择层级\n    showChannelLevel() {\n      return this.selectedSite && \n             this.currentSite.type === 'complex' && \n             this.currentSite.channels && \n             this.currentSite.channels.length > 0\n    },\n    \n    // 是否显示内容层级\n    showContentLevel() {\n      if (!this.selectedSite) return false\n      \n      // 夹子：选中即显示\n      if (this.currentSite.type === 'special') {\n        return true\n      }\n      \n      // 简单榜单：选中即显示\n      if (this.currentSite.type === 'simple') {\n        return true\n      }\n      \n      // 复杂榜单：需要选中频道才显示\n      if (this.currentSite.type === 'complex') {\n        return this.selectedChannel !== ''\n      }\n      \n      return false\n    }\n  },\n  \n  onLoad() {\n    this.loadSites()\n  },\n  \n  methods: {\n    /**\n     * 加载分站数据\n     */\n    loadSites() {\n      try {\n        // 从本地数据文件加载\n        this.sites = getSitesList()\n        console.log('分站数据加载成功:', this.sites)\n      } catch (error) {\n        console.error('加载分站数据失败:', error)\n      }\n    },\n    \n    /**\n     * 选择分站\n     */\n    selectSite(site) {\n      this.selectedSite = site.id\n      this.currentSite = site\n      \n      // 清空频道选择\n      this.selectedChannel = ''\n      this.currentChannel = {}\n      \n      // 根据分站类型加载对应内容\n      if (site.type === 'special') {\n        // 夹子：加载书籍列表\n        this.loadBookList(site.id)\n      } else if (site.type === 'simple') {\n        // 简单榜单：加载榜单列表\n        this.loadRankings(site.id)\n      }\n      // 复杂榜单：等待用户选择频道\n    },\n    \n    /**\n     * 选择频道\n     */\n    selectChannel(channel) {\n      this.selectedChannel = channel.id\n      this.currentChannel = channel\n      \n      // 加载频道对应的榜单\n      this.loadRankings(this.selectedSite, channel.id)\n    },\n    \n    /**\n     * 重置到分站层级\n     */\n    resetToSiteLevel() {\n      this.selectedChannel = ''\n      this.currentChannel = {}\n      \n      // 重新加载分站内容\n      if (this.currentSite.type === 'special') {\n        this.loadBookList(this.selectedSite)\n      } else if (this.currentSite.type === 'simple') {\n        this.loadRankings(this.selectedSite)\n      }\n    },\n    \n    /**\n     * 重置到频道层级\n     */\n    resetToChannelLevel() {\n      // 重新加载频道内容\n      this.loadRankings(this.selectedSite, this.selectedChannel)\n    },\n    \n    /**\n     * 加载榜单数据\n     */\n    async loadRankings(siteId, channelId = '') {\n      try {\n        // 这里应该调用API获取榜单数据\n        // const response = await this.$http.get('/api/rankings', { siteId, channelId })\n        // this.rankingList = response.data\n        \n        console.log('加载榜单数据:', siteId, channelId)\n        \n        // 临时模拟数据\n        this.rankingList = [\n          {\n            id: '1',\n            name: '热门榜单',\n            desc: '当前最受欢迎的作品',\n            bookCount: 50,\n            updateTime: '2小时前更新'\n          },\n          {\n            id: '2', \n            name: '新书榜单',\n            desc: '最新发布的优质作品',\n            bookCount: 30,\n            updateTime: '1小时前更新'\n          },\n          {\n            id: '3',\n            name: '完结榜单',\n            desc: '已完结的优质作品',\n            bookCount: 25,\n            updateTime: '6小时前更新'\n          }\n        ]\n      } catch (error) {\n        console.error('加载榜单数据失败:', error)\n      }\n    },\n    \n    /**\n     * 加载夹子书籍列表\n     */\n    async loadBookList(siteId) {\n      try {\n        // 这里应该调用API获取夹子书籍数据\n        // const response = await this.$http.get('/api/jiazi/books')\n        // this.bookList = response.data\n        \n        console.log('加载夹子书籍数据:', siteId)\n        \n        // 临时模拟数据\n        this.bookList = [\n          {\n            id: '1',\n            title: '重生之商业帝国',\n            collections: 15680,\n            collectionChange: 245,  // 正数表示增加\n            rankChange: -2  // 负数表示排名上升，正数表示排名下降\n          },\n          {\n            id: '2',\n            title: '穿越古代当皇后',\n            collections: 12450,\n            collectionChange: -89,\n            rankChange: 1\n          },\n          {\n            id: '3',\n            title: '现代都市修仙录',\n            collections: 11230,\n            collectionChange: 156,\n            rankChange: 0\n          },\n          {\n            id: '4',\n            title: '娱乐圈的那些事',\n            collections: 9870,\n            collectionChange: 78,\n            rankChange: -1\n          },\n          {\n            id: '5',\n            title: '末世重生女配逆袭',\n            collections: 8950,\n            collectionChange: -23,\n            rankChange: 3\n          }\n        ]\n      } catch (error) {\n        console.error('加载夹子书籍数据失败:', error)\n      }\n    },\n    \n    /**\n     * 搜索功能\n     */\n    onSearch() {\n      // 实现搜索逻辑\n      console.log('搜索关键词:', this.searchKeyword)\n    },\n    \n    /**\n     * 跳转到榜单详情\n     */\n    goToRankingDetail(ranking) {\n      uni.navigateTo({\n        url: `/pages/ranking/detail?id=${ranking.id}`\n      })\n    },\n    \n    /**\n     * 跳转到夹子榜单详情\n     */\n    goToJiaziDetail() {\n      uni.navigateTo({\n        url: `/pages/ranking/detail?id=jiazi&type=special`\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.ranking-container {\n  padding: 20rpx;\n}\n\n.search-section {\n  margin-bottom: 30rpx;\n}\n\n.search-input {\n  width: 100%;\n  height: 80rpx;\n  padding: 0 30rpx;\n  border: 2rpx solid #e0e0e0;\n  border-radius: 40rpx;\n  background-color: #f8f8f8;\n  font-size: 28rpx;\n}\n\n.breadcrumb {\n  margin-bottom: 20rpx;\n  font-size: 24rpx;\n  color: #666;\n}\n\n.breadcrumb-item {\n  color: #007aff;\n}\n\n.breadcrumb-separator {\n  margin: 0 10rpx;\n}\n\n.level-container {\n  margin-bottom: 30rpx;\n}\n\n.site-scroll, .channel-scroll {\n  white-space: nowrap;\n}\n\n.site-tabs, .channel-tabs {\n  display: flex;\n  padding: 10rpx 0;\n}\n\n.site-tab, .channel-tab {\n  flex-shrink: 0;\n  padding: 20rpx 40rpx;\n  margin-right: 20rpx;\n  background-color: #f0f0f0;\n  border-radius: 50rpx;\n  font-size: 28rpx;\n  color: #333;\n  transition: all 0.3s ease;\n  \n  &.active {\n    background-color: #007aff;\n    color: white;\n    font-weight: bold;\n  }\n}\n\n.ranking-list {\n  height: 1000rpx;\n}\n\n.ranking-card {\n  padding: 30rpx;\n  margin-bottom: 20rpx;\n  background-color: white;\n  border-radius: 20rpx;\n  box-shadow: 0 2rpx 10rpx rgba(0,0,0,0.1);\n}\n\n.ranking-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 10rpx;\n}\n\n.ranking-desc {\n  font-size: 26rpx;\n  color: #666;\n  margin-bottom: 15rpx;\n}\n\n.ranking-stats {\n  display: flex;\n  justify-content: space-between;\n  font-size: 24rpx;\n  color: #999;\n}\n\n/* 夹子书籍列表样式 */\n.book-list-container {\n  margin-top: 20rpx;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20rpx 0;\n  margin-bottom: 20rpx;\n  border-bottom: 2rpx solid #f0f0f0;\n}\n\n.section-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.detail-btn {\n  padding: 10rpx 20rpx;\n  background-color: #007aff;\n  color: white;\n  border: none;\n  border-radius: 20rpx;\n  font-size: 24rpx;\n}\n\n.book-list {\n  height: 800rpx;\n}\n\n.book-item {\n  display: flex;\n  align-items: center;\n  padding: 25rpx 20rpx;\n  margin-bottom: 15rpx;\n  background-color: white;\n  border-radius: 15rpx;\n  box-shadow: 0 2rpx 8rpx rgba(0,0,0,0.1);\n}\n\n.book-rank {\n  width: 60rpx;\n  height: 60rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #007aff;\n  color: white;\n  border-radius: 50%;\n  font-size: 24rpx;\n  font-weight: bold;\n  margin-right: 20rpx;\n}\n\n.book-info {\n  flex: 1;\n}\n\n.book-title {\n  font-size: 30rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 10rpx;\n  line-height: 1.4;\n}\n\n.book-stats {\n  display: flex;\n  flex-direction: column;\n  gap: 8rpx;\n}\n\n.stat-item {\n  font-size: 24rpx;\n  color: #666;\n}\n\n.change-indicator {\n  margin-left: 10rpx;\n  font-weight: bold;\n  \n  &.up {\n    color: #ff4d4f; /* 红色表示上升/增加 */\n  }\n  \n  &.down {\n    color: #52c41a; /* 绿色表示下降/减少 */\n  }\n}\n\n/* 内容容器样式 */\n.content-container {\n  margin-top: 20rpx;\n}\n\n.ranking-list-container {\n  margin-top: 20rpx;\n}\n</style> ","import MiniProgramPage from '/Users/guliyu/weixin-miniapp/JJClawler-frontend/JJClawler-frontend/pages/ranking/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["getSitesList","uni"],"mappings":"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"}